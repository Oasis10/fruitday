{%extends 'base.html'%}

{%block content%}
<div class="main_wrap clearfix">
			<div class="sort_bar">
				搜索&nbsp;<b>{{query}}</b>&nbsp;结果如下：
			</div>

			<ul class="goods_type_list clearfix">
                {%for item in page%}
				<li>
					<a href="/{{item.object.id}}/"><img src="/static/{{item.object.pic}}"></a>
					<h4><a href="#">{{item.object.title}}</a></h4>
					<div class="operate">
						<span class="prize">￥{{item.object.price}}</span>
						<span class="unit">{{item.object.price}}/{{item.object.unit}}</span>
						<a href="javascript:;" class="add_goods" title="加入购物车" value="{{item.object.id}}"></a>
					</div>
				</li>
                {%empty%}
                <li>啥也没找到</li>
                {%endfor%}
			</ul>

			<div class="pagenation">
                {%if page.has_previous%}
				<a href="?q={{query}}&amp;page=1">首页</a>
				<a href="?q={{query}}&amp;page={{page.number|add:-1}}"><上一页</a>
                {%endif%}

            {%for index in page.paginator.page_range%}
                {%if index == page.number%}
				    <a href="#" class="active">{{index}}</a>
                {%else%}
				    <a href="?q={{query}}&amp;page=index">{{index}}</a>
                {%endif%}
            {%endfor%}

                {%if page.has_next%}
				<a href="?q={{query}}&amp;page={{page.number|add:1}}">下一页></a>
                {%endif%}
			</div>
		</div>
    </div>
	<script text="text/javascript">
	var $add = $(".add_goods");
	var $cart = $("#show_count");
	$(".add_goods").click(function () {
		var gid = $(this).attr("value");
			$.get("/cart/add/", {"gid":gid, "count":1}, function (data) {
		if(data.is_login==0){
			location.href = "/user/login/";
			return;
		}
		else{
			$cart.html(data.count)
		}});});
	</script>

{%endblock content%}